Kommen wir im nächsten Schritt zu **Datentypen und Zellformatierungen**.  
Dabei ist ein wichtiger Grundsatz zu verinnerlichen:

**Der Datentyp bestimmt den Charakter eines Wertes. Die Zellformatierung bestimmt nur sein Aussehen.**

Einfach gesagt:  
Der Datentyp ist das, was Excel weiß – z. B. Zahl, Text, Datum, Wahrheitswert (Boolesch).  

Die Zellformatierung ist das, was Excel anzeigt – z. B. mit Tausendertrennzeichen, Währungszeichen oder Datumsstil.

Und das führt zur wichtigsten Unterscheidung:
**Ein Datentyp kann die Formatierung beeinflussen –  aber eine Formatierung verändert niemals den tatsächlichen Datentyp.**

### Beispiel:
Eine Zelle mit dem Inhalt `10.000` kann visuell wie eine Zahl aussehen –  
aber wenn sie eigentlich ein Textwert ist bleibt sie für Excel auch Text, selbst wenn sie aussieht wie eine Zahl.

Stell dir den Datentyp wie den Inhalt eines Geschenks vor, also das was du auch wirklich geschenkt bekommst und am Ende in den Händen hältst – die Zellformatierung ist nur das Geschenkpapier. Ob auf dem Geschenkpapier jetzt Blümchen oder Feuerwehrautos gedruckt sind, ändert nichts an dem Inhalt des Geschenks.

---
Hierarchisch betrachtet beginnen wir also mit dem Fundament:

# Datentypen
Excel unterscheidet oberflächlich zwischen sechs verschiedenen Datentypen:

## Zahlen
Zahlen. Nun was soll man dazu groß ausführen. Zahlen sind Zahlen und liegen als solche auch Excel vor. Vielleicht ist zu erwähnen, dass Excel intern immer "nur" Dezimal- oder Ganzzahlen abspeichert und mit diesen rechnet. Dabei ist es egal, ob die Darstellung als wissenschaftliche Schreibweise, Bruch, Prozentzahl, etc. stattfindet. `50%` wird von Excel als 0,5 gespeichert und `1.00E+02` als 100. 

## Datum- und Zeitangaben
Das zu unrecht deklarierte Sorgenkind von Excel.
Datums- und Zeitangaben werden in Excel ebenfalls als Ganz- oder Dezimalzahl abgespeichert. Vielleicht sagst du dir jetzt "Ja klar, 14 Uhr 20. Zwei Ganzzahlen. Easy.". Aber wenn du 14:20h meinst, sagt Excel dir `0,597222`. Oder um es greifbarer auszudrücken:
0 Uhr ist 0,00 und 24 Uhr ist 1,00. Zumindest wenn du nur eine Uhrzeit angibst.
Sobald du, auch wenn es sich nur um eine Uhrzeit handelt, 14:20h als Datum und Uhrzeit deklarierst, wird es als 1,597222 abgespeichert. Ok, doch nicht so logisch. 

Zäumen wir das Pferd von hinten auf. Excel rechnet in seiner **Datums**berechnung ab dem 01.01.1900. Das ist, wenn man so möchte, Tag 1 und wird intern auch mit einer 1 abgespeichert. Möchten wir jetzt das Datum 05.01.1900 angeben, wird dieses intern mit einer 5 abgespeichert. Und jetzt wird es spannend. Da wir uns nicht mehr am Anfang des 20. Jahrhunderts befinden, wollen wir aktuelle Daten anzeigen. Nehmen wir als Beispiel den 13.03.2025, speichert Excel dieses Datum als 45729 ab, da es sich 45.728 Tage nach dem 01.01.1900 befindet. Uhrzeiten werden weiterhin als "Fraktale" bzw. Nachkommastellen behandelt. Dieser Logik folgend wird der 13.03.2025 14:20h also als 45729,597222 abgespeichert.


## Text
Text ist...nunja. Text eben. Zahlen können aber ebenfalls als Text vorliegen. Oder Währungen als Text. Man kann Excel durch Formeln auch explizit zwingen Zahlen oder anderes als Text anzeigen zu lassen. Hierzu aber später mehr. 
Der Datentyp Text wird von Excel immer dann verwendet, sobald etwas "nicht numerisches" in einer Zelle enthalten ist. Mit anderen Worten: Irgendwas anderes außer einer Ganz- oder Dezimalzahl. Interessant wird es natürlich dann, wenn wir aus einem als Text formatierten Zellwert Daten und Zahlen extrahieren wollen. Auch dies ist relativ leicht über Formeln möglich. Du siehst, diese Thematik wird nach hinten raus noch wesentlich weiter ausgeführt. 


> [!INFO] Auf einen Blick erkennen, ob es sich um eine Zahl als Zahl oder um eine Zahl als Text handelt!
> Das geübte Auge kann an einer Zelle direkt erkennen, ob Excel den Wert als Text oder tatsächlich als Zahl behandelt. Und zwar anhand der Ausrichtung des Wertes innerhalb der Zelle. Wenn nicht vom Benutzer in die Zellausrichtung eingegriffen wurde, befindet sich Text immer linksbündig und Zahlen rechtsbündig. Alleine hierdurch kann man relativ viele Fehlerquellen schnell identifizieren.

## Boolesche Werte (Wahrheitstypen)
Bei dem booleschen Datentyp handelt es sich um ein sehr mächtiges Werkzeug innerhalb Excels. Auch dieser wird rein theoretisch als Zahl abgespeichert, weist aber die Besonderheit auf, dass es sich hierbei nur um 2 Ganzzahlen handelt. Keine Nachkommastellen, keine andere Darstellung. Diese Zahlen lauten `1` und `0` und werden im booleschen Denken von Excel als `TRUE` und `FALSE` interpretiert. 

Das ist wichtig zu verstehen, da uns der boolesche Datentyp mehr oder weniger verschleiert in sehr vielen Formeln über den Weg läuft. Ebenfalls arbeitet Excel bei Bedingungsüberprüfungen mit dem booleschen Datentyp.

An dieser Stelle sei die doppelte Negierung in Form von zwei aufeinanderfolgenden Minus-Zeichen (`--`) vorweg gegriffen. Dadurch haben wir die Möglichkeit die booleschen Werte `TRUE` und `FALSE` in ihr numerisches Äquivalent zu ändern. Sehr spannend, wenn es um mehrere Bedingungen oder Multiplikation mit Wahrheitswerten geht.

```
=TRUE() --> Ausgabe: TRUE
=--TRUE() --> Ausgabe: 1
```


## Error
Excel kennt eine ganze Reihe klar definierter Fehlerarten – und setzt sie oft sehr gezielt ein, auch wenn das auf den ersten Blick nicht so aussieht.  
Manche davon sind echte Rechenprobleme, andere eher situationsbedingt, wieder andere einfach Hinweise à la „Du bist zwar nicht gescheitert, aber auch nicht angekommen“.

### Die Raute
Als erstes sei ein "Fehler" genannt, der eigentlich keiner ist, sondern nur Excels Art uns zu sagen, dass unsere Spalte zu klein ist. Falls wir in einer Zelle, in der eigentlich ein numerischer Wert stehen sollte, eine lange Zeichenfolge von Rauten, oder zu Neu-Deutsch "Hashtags", (`#`) sehen, ist das nur ein Zeichen dafür, dass wir die Spalte etwas größer ziehen müssen. Entweder per Drag and Drop oder mit einem Doppelklick auf die Abgrenzung des jetzigen und nächsten Spaltenbuchstaben.

### \#DIV/0!
**Division durch Null** – tritt auf, wenn in einer Formel durch `0` oder eine leere Zelle geteilt wird.  
Typisch z. B. bei Verhältniszahlen.
Bedarf keinem Beispiel. Wer durch 0 teilen kann, killt die Mathematik, jeden Computer mit Prozessor, Roboter, vermutlich das gesamte Universum und kennt die Formel zur Singularität aus dem Kopf.

### \#VALUE!
Falscher Datentyp – Excel erwartet eine Zahl, erhält aber Text oder inkompatible Elemente (z. B. ="Text"\*2).
Häufig bei Operatorfehlern oder inkonsistenten Zellinhalten.
Das Excel-Äquivalent zu: "Du versuchst Äpfel mit Birnen zu vergleichen."

### \#NAME?
Unbekannter Funktionsname oder Bereichsname – z. B. durch Tippfehler in einer Funktion (=SUME() statt =SUM()), fehlende Anführungszeichen oder ein Verweis auf einen nicht definierten Namen.
Das fragt sich dein Postbote, wenn du umgezogen bist, aber das Klingelschild noch nicht geändert hast. Gleiches Prinzip.

### \#REF!
Ungültiger Zellbezug – entsteht, wenn eine referenzierte Zelle gelöscht oder der Bereich verschoben wurde.
Klassisch in VLOOKUP(), INDEX() oder dynamischen Bereichsbezügen.
Das sagt dein Postbote, wenn dein Haus auf einmal weg ist.

### \#NUM!
Ungültige Zahl – z. B. bei mathematisch unmöglichen Operationen (=SQRT(-1)) oder bei extremen Werten, die Excel nicht darstellen kann.
Excels Art uns zu sagen, dass wir die Rechenlogik eventuell nochmal überdenken sollten.

### \#N/A
Kein Wert verfügbar – typisches Ergebnis von XLOOKUP(), MATCH(), FILTER() usw., wenn kein Treffer vorliegt.
Kein „technischer Fehler“, sondern ein sinnvoller Rückgabewert zur Signalisierung von „nicht gefunden“.
Standardantwort eines Teenagers, der etwas im Haushalt suchen soll, aber nichts findet.

### \#NULL!
Ungültige Schnittmenge – sehr selten. Entsteht, wenn Excel zwei Bereiche als Schnittmenge interpretiert, die keinen logischen Zusammenhang haben (=SUM(A1 A2) statt =SUM(A1,A2)).
Satzzeichen gehören zu einer ordentlichen Sprache, genauso wie zu ordentlichen Formeln.

### \#CALC!
Allgemeiner Berechnungsfehler – tritt auf, wenn Excel im dynamischen Berechnungsprozess auf ein Problem stößt (z. B. zirkuläre Bezüge, fehlerhafte Spill-Bereiche oder komplexe Abhängigkeitskonflikte).
Tatsächlich fällt mir hier kein lustiges Beispiel ein. Ärgerlich wenn er vorkommt, aber mit Logik gut zu begreifen. Meistens geht man hier dann in einzelne Formelauflösung über um den Berechnungsfehler zu finden.

### \#SPILL!
Spill-Fehler bei dynamischen Arrays – die Formel kann nicht ihr gesamtes Ergebnis anzeigen, weil angrenzende Zellen bereits belegt sind oder ein blockierender Zellbereich besteht.
Lösbar durch Freigabe des Zielbereichs.
Schonmal versucht ein 5m langes Metallstück in ein 3m langes Loch zu bekommen? Richtig. Geht nicht. Ergo: Loch vergrößern.

### \#BLOCKED!
Blockierte Berechnung – verursacht durch Sicherheits- oder Datenschutzeinschränkungen, z. B. bei geschützten Dateien, externen Abfragen oder Add-In-basierten Funktionen.
Der Türsteher der Fehler.

### \#CONNECT!
Verbindungsfehler – Excel kann keine Verbindung zu einer externen Datenquelle herstellen.  
Tritt z. B. auf, wenn eine Power Query-Verbindung abbricht, ein externer Dienst (Power BI, Datenmodell, Cloud-Service) nicht verfügbar ist oder der Authentifizierungstoken abgelaufen ist.
Du willst jemanden anrufen, aber die Person hat entweder kein Signal oder kein Handy.

### \#FIELD!
Nicht auffindbares Feld – tritt auf, wenn strukturierte Verweise (Table\[Column]) auf ein gelöschtes oder nicht existierendes Feld zeigen.
Auch in Power Query-Ergebnissen relevant.
Dein Postbote, wenn dein Haus zwar noch da ist, du aber den Briefkasten entfernt hast.

### \#GETTING_DATA
Datenabruf läuft noch – Excel wartet auf die Rückgabe externer Datenquellen (Power BI, OLAP, Webabfragen).
Temporärer Zustand, kein „echter“ Fehler.
Ich, morgens nach dem Aufstehen und vor dem ersten Kaffee. Braucht ein bisschen.

### \#PYTHON!
Fehler im Python-Connector – tritt auf, wenn ein Python-Skript im neuen Excel-Python-Modul fehlschlägt. Nur der Vollständigkeit halber erwähnt, nichts womit wir uns befassen.

### \#UNKNOWN!
Unbekannter Fehler – Excel weiß selbst nicht genau, was das Problem ist.  
Dieser Fehler tritt meist auf, wenn eine Funktion oder ein Ausdruck auf ein unbekanntes Element zugreift, das (noch) nicht korrekt interpretiert oder unterstützt wird.
Herzlichen Glückwunsch, du hast einen Fehler produziert, den Excel selbst noch nicht kennt. Tritt aber in den seltensten Fällen auf.

### Errorhandling
An dieser Stelle sei erwähnt, dass Excel natürlich auch ein Errorhandling eingebaut hat. Dies kann entweder in der Formel selbst, bspw. bei `XLOOKUP` oder über `ISERROR`, `IFERROR`, `ERROR.TYPE`, usw. geschehen. Dem Thema des Errorhandlings wird aber noch ein kompletter Block gewidmet.


## Array

# Formatierung
###  General
Quasi der Freefloater unter den Datentypen. "General" entscheidet, letztendlich abhängig von Spaltengröße und Zahlenlänge, wie die eingegebene Zahl angezeigt werden soll.

### Number
 Mit "Number" wird generell eine Ganz- oder Dezimalzahl deklariert. Hierbei ist zu beachten, dass die Dezimalstellen nur in der Anzeige, also als Formatierung, gerundet werden, nicht aber die Zahl verändert.

 Geben wir die Zahl 42,6874 ein und stellen die Dezimalstellen auf "2", wird uns die Zahl 42,69 **angezeigt**. In der Zelle selbst steht aber nach wie vor noch unsere 42,6874, mit der Excel intern auch weiter rechnet. 

 Negative Zahlen werden mit einem `-` angezeigt.

### Currency
Wie der Name schon vermuten lässt, legt man mit "Currency" fest, dass es sich bei der eingegebenen Zahl um eine Währungszahl handelt. So wird aus einer 10 ein `10,00 €` oder ein `$ 10.00`. Als Währung können hierbei eine Vielzahl von länderspezifischen Währungen angegeben werden. Die Formatierung (das Aussehen) orientiert sich dann an der normalen Darstellung dieser Währung.

Wenn man eine Zahl direkt mit Währungszeichen eingibt, erkennt Excel in der Regel automatisch den Datentyp "Currency". Nichtsdestotrotz kann dies, insbesondere wenn man später Werte aus PDF oder anderen Tabellen übernimmt, für Verwirrung sorgen. So kann es auch vorkommen, dass Excel einen kopierten Wert ohne Datentyp übernimmt und aus dem Datentyp "Currency" `10,00 €` plötzlich einfach nur der Datentyp "Text" "10,00 €" wird.

### Accounting
### Percentage
### Fraction
### Scientific
### Dates
### Time
