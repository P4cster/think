
# üìÑ `VLOOKUP()`

Kommen wir zur Formel, die f√ºr rund 90‚ÄØ% aller ‚ÄûIch kann Excel‚Äú-Aussagen verantwortlich ist. Direkt vorweg: Sowohl `VLOOKUP` als auch `HLOOKUP` werden hier nur der Vollst√§ndigkeit halber behandelt ‚Äì und weil sie √ºber Jahre hinweg als _die_ Excel-Formeln galten.

Fakt ist: Beide Funktionen gelten inzwischen als √ºberholt. Die moderne Alternative hei√üt `XLOOKUP` ‚Äì flexibler, robuster und konzeptionell klarer. `VLOOKUP` und `HLOOKUP` geh√∂ren damit in die Rubrik _legacy_, sollten also nur noch dort eingesetzt werden, wo es zwingend notwendig ist ‚Äì etwa in bestehenden Altdateien oder zur Abw√§rtskompatibilit√§t.

## üîπ Syntax
`=VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])`

### Parameter

| Parameter       | Beschreibung                                                                  | Pflichtangabe | erwarteter Datentyp            |
| --------------- | ----------------------------------------------------------------------------- | ------------- | ------------------------------ |
| lookup_value    | Wert oder Text, der gesucht werden soll                                       | Ja            | Zelle, Bereich, Tabelle, Array |
| table_array     | ein- bis zweidimensionaler Bereich, der durchsuchtwerden soll                 | Ja            | Bereich, Tabelle, Array        |
| col_index_num   | Spaltenanzahl von erster bis zur Ergebnisspalte, welche ausgegeben werden soll | Ja            | Zahl, Formel                   |
| \[range_lookup] | √ºberpr√ºft auf "approximate match (1)" oder "exact match (0) (default)"        | Nein          | bool                           |

## üîç In einfacher Sprache
*Was macht diese Funktion eigentlich ‚Äì ohne Fachchinesisch?*
> Mit der `VLOOKUP` wird immer die erste Spalte im angegebenen Bereich (`table_array`) nach dem `lookup_value` durchsucht. 
> Von dort aus z√§hlt man eine bestimmte Anzahl Spalten weiter nach rechts (`col_index_num`) und nimmt sich aus der gleichen Zeile den Wert dieser Spalte.
> Was zur H√∂lle. Richtig. Deswegen `XLOOKUP`. 
> Die `VLOOKUP` ist die folgende Aussage als Formel:
> "Schau mal bitte in dem Regal da hinten. Dort findest du im ersten Fach Schrauben. Gib mir jetzt aus dem dritten Fach von rechts den passenden Schraubenzieher aus derselben Regalreihe.‚Äú
> Oder nochmal anders: `VLOOKUP` fragt nicht ‚ÄûWas willst du?‚Äú, sondern ‚ÄûWo stehst du, und wie weit soll ich z√§hlen?‚Äú ‚Äì das ist der eigentliche Denkfehler dieser Funktion.

## üìå Wof√ºr ist das n√ºtzlich?
Die Vorteile von LOOKUP-Funktionen sind relativ selbsterkl√§rend. Wir k√∂nnen eine Datenbank in Form einer Tabelle, eines Bereichs, Arrays, Datenmodell, etc. nach einem bestimmten Wert durchsuchen und einen damit relationalen anderen Wert zur√ºck geben, der dann entweder angezeigt oder weiter verwendet werden soll.

## üî¢ Beispiel
```excel
# Sucht in Spalte A vom Bereich A1:C15 nach "test" und gibt den passenden Wert aus der dritten Spalte zur√ºck (C)
=VLOOKUP("test", A1:C15, 3)

# Sucht in Spalte C vom Bereich C6:G20 nach 15 und gibt den passenden Wert aus der zweiten Spalte (ab C) zur√ºck (D)
=VLOOKUP(15, C6:G20, 2)

# Sucht nach der Zahl 13 und allen h√∂heren Vorkommen in Spalte A und gibt das Ergebnis aus der 3. Spalte ausgehend von A, also C, zur√ºck. Spalte A muss dabei aufsteigend sortiert sein, damit "approximate match" funktioniert.
=VLOOKUP(13, A1:C15, 3, 1)
```

## üí° Kreativer Einsatz
*Wie l√§sst sich die Funktion clever kombinieren oder zweckentfremden?*
So gut wie jede clevere Integration, welche mit der `VLOOKUP`m√∂glich ist, ist besser mit `XLOOKUP`.

## ‚ö† Typische Fehlerquellen
- `#N/A` - nicht anwendbar --> gesuchter Wert existiert nicht in der ersten Spalte
- `#N/A` bei "approximate match" --> erste Spalte ist nicht aufsteigend sortiert
- `#REF` - Bereich zu klein (`A1:B15` nur zwei Spalten, aber er soll in der 5. suchen)
- Absoluter Endgegner, wenn man einen approximate match auf Text machen m√∂chte

___

# üìÑ `HLOOKUP()`

## üîπ Syntax
`=HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])`

### Parameter

| Parameter       | Beschreibung                                                                  | Pflichtangabe | erwarteter Datentyp            |
| --------------- | ----------------------------------------------------------------------------- | ------------- | ------------------------------ |
| lookup_value    | Wert oder Text, der gesucht werden soll                                       | Ja            | Zelle, Bereich, Tabelle, Array |
| table_array     | ein- bis zweidimensionaler Bereich, der durchsuchtwerden soll                 | Ja            | Bereich, Tabelle, Array        |
| row_index_num   | Reihenanzahl von erster bis zur Ergebniszeile, welche ausgegeben werden soll | Ja            | Zahl, Formel                   |
| \[range_lookup] | √ºberpr√ºft auf "approximate match (1)" oder "exact match (0) (default)"        | Nein          | bool                           |

## üîç In einfacher Sprache
*Was macht diese Funktion eigentlich ‚Äì ohne Fachchinesisch?*
> Haargenau die gleiche Funktionsweise wie `VLOOKUP` nur mit dem Unterschied, dass hier nicht vertikal `V-LOOKUP`, sondern horizontal `H-LOOKUP`, geschaut wird. Hei√üt wir durchsuchen diesmal nicht die erste Spalte, sondern die erste Zeile und z√§hlen dann runter.

Respektive der Tatsache, dass sich ansonsten alles mit der `VLOOKUP` deckt, gehen wir hier nicht weiter auf die `HLOOKUP` ein. 

Es sei auch nochmals betont. Beide hier vorgestellten Formeln sind lediglich deshalb aufgef√ºhrt, weil sie in verdammt vielen Excel-Tabellen vorkommen. Gew√∂hnt euch aber direkt von Anfang an die Verwendung von `XLOOKUP` an. Springt auch gerne zu dieser Lektion vor, wenn ihr nicht warten k√∂nnt, aber kommt dann wieder zur√ºck.