
# ğŸ“„ `IF()`

## ğŸ”¹ Syntax
`=IF(logical_test, value_if_true, [value_if_false])`

### Parameter

| Parameter         | Beschreibung                                                             | Pflichtangabe | erwarteter Datentyp      |
| ----------------- | ------------------------------------------------------------------------ | ------------- | ------------------------ |
| logical_test      | Die Bedingung auf die Ã¼berprÃ¼ft wird. Resultiert in `TRUE` oder `FALSE`. | Ja            | bool                     |
| value_if_true     | Was soll passieren, wenn logical_test `TRUE` zurÃ¼ck gibt?                | Ja            | Formel, Wert, Text, etc. |
| \[value_if_false] | Was soll passieren, wenn logical_test `FALSE` zurÃ¼ck gibt?               | Nein          | Formel, Wert, Text, etc. |

## ğŸ” In einfacher Sprache - etwas ausfÃ¼hrlicher

Die IF-Formel ist eine grundlegende Formel die dann zum tragen kommt, wenn man zwei verschiedene "AusgÃ¤nge" von einem Ereignis abhÃ¤ngig machen mÃ¶chte. Es handelt sich hierbei um eine der sogenannten "logischen Funktionen".
Ihr kÃ¶nnt euch das wie folgt vorstellen:

"Wenn meine Freundin heute abend Zeit hat, gehe ich mit ihr essen, ansonsten bleibe ich zuhause."

Hierbei ist die Variable, die sich verÃ¤ndern kann die Zeit der Freundin. Die beiden anschlieÃŸenden MÃ¶glichkeiten sind abhÃ¤ngig von dieser Entscheidung. 

In Excel sÃ¤he das ganze dann so aus:

```
=IF(Freundin=Zeit, essen gehen, zuhause bleiben)
```

Das ganze in der Syntax ist wie folgt beschrieben:

```
=IF(Wahrheitstest, was passiert wenn wahr, was passiert wenn falsch)
```

Der `Wahrheitstest` ist dabei in der Regel (fast immer) ein Vergleich, also `=`, `<`, `>`, `<=`, `>=` oder `<>`. Alle diese Bedingungen werden fÃ¼r Excel in ein "stimmt" oder "stimmt nicht" aufgelÃ¶st. Mit anderen Worten ein `TRUE` oder ein `FALSE` und dementsprechend wird dann das jeweilige "was passiert wenn wahr" oder "was passiert wenn falsch" ausgelÃ¶st.

Also:

```
=IF(Freundin=Zeit, essen gehen, zuhause bleiben)

=IF(Freundin hat Zeit (TRUE), essen gehen, -)

=IF(Freundin hat keine Zeit (FALSE), - , zuhause bleiben)
```

### Verschachtelte `IF`-Funktion
Das Thema der IF-Funktionen kann man jetzt noch auf die Spitze treiben und anfangen zu verschachteln. Bleiben wir bei unserem Beispiel und erweitern um die Auswahl des Essens, aber nur dann, wenn unsere Freundin Zeit hat, um mit uns essen zu gehen.

HierfÃ¼r legen wir die Bedingung fest:

Wenn wir Lust auf Pizza haben, gehen wir in ein italienisches Restaurant, ansonsten mexikanisch.

```
=IF(Freundin=Zeit, IF(Lust = Pizza, italienisch, mexikanisch), zuhause bleiben)
```

In unserem Beispiel haben wir nun unsere "was passiert wenn wahr" gegen die Wahl des Essens ausgetauscht. Also:

```
=IF(Freundin hat Zeit (TRUE), IF(Lust = Pizza, italienisch, mexikanisch), - )
```

Unsere Freundin hat Zeit, also gehen wir was essen und die Option zuhause zu bleiben verfÃ¤llt. Jetzt kommen wir dementsprechend an die Entscheidung ob wir Lust auf Pizza haben:

```
=IF(Freundin hat Zeit (TRUE), IF(wir haben Lust auf Pizza (TRUE), italienisch, -), - )
```

Also:

```
=IF(Freundin hat Zeit (TRUE), IF(wir haben Lust auf Pizza, italienisch, -), - )

=IF(Freundin hat Zeit, italienisch, -)
```

Und nein, ich plane meine Dates nicht mit Excel. So gut bin ich dann auch nicht.

### Mehrfach verschachtelte `IF`-Funktion
Mehrfach verschachtelte `IF`-Funktionen sind natÃ¼rlich ebenfalls mÃ¶glich. Also eine `IF`-Funktion, in der eine `IF`-Funktion, in der eine `IF`-Funktion, in der eine `IF`-Funktion, in der eine, usw. eingesetzt wird. 
Wenn wir dabei mit numerischen Werten arbeiten, mÃ¼ssen wir darauf achten, dass wir die BedingungsprÃ¼fungen logisch absteigend/aufsteigend aufbauen. Das heiÃŸt, dass wir erst auf den grÃ¶ÃŸten/kleinsten Wert Ã¼berprÃ¼fen, dann auf den nÃ¤chstkleineren/nÃ¤chstgrÃ¶ÃŸeren, usw.

```
# festgelegte Variable:
varZahl = 25

IF(
varZahl >= 40, "Die Variable ist grÃ¶ÃŸer als 40.", IF(
	varZahl >= 30, "Die Variable ist grÃ¶ÃŸer als 30.", IF(
		varZahl >= 20, "Die Variable ist grÃ¶ÃŸer als 20.", IF(
			varZahl >=10, "Die Variable ist grÃ¶ÃŸer als 10.", IF(
				varZahl < 10, "Die Variable ist kleiner als 10."
)))))
```

Wenn unsere Zahl grÃ¶ÃŸer oder gleich 40 ist, hÃ¶rt die mehrfach verschachtelte `IF`-Funktion bei der ersten Bedingung auf weiter zu Ã¼berprÃ¼fen und gibt den Text "Die Variable ist grÃ¶ÃŸer als 40." zurÃ¼ck. Sollte da nicht der Fall sein, wird die nÃ¤chste ÃœberprÃ¼fung getriggert. Mit anderen Worten: Es wird so lange Ã¼berprÃ¼ft, bis die erste Bedingung ein `TRUE` zurÃ¼ck gibt.

Diesem Muster folgend lÃ¶st sich die Formel also wie folgt auf.
```
# festgelegte Variable:
varZahl = 25

=IF(
varZahl >= 40, "Die Variable ist grÃ¶ÃŸer als 40.", IF(
	varZahl >= 30, "Die Variable ist grÃ¶ÃŸer als 30.", IF(
		varZahl >= 20, "Die Variable ist grÃ¶ÃŸer als 20.", IF(
			varZahl >=10, "Die Variable ist grÃ¶ÃŸer als 10.", IF(
				varZahl < 10, "Die Variable ist kleiner als 10."
)))))

=IF(
FALSE, -, IF(
	varZahl >= 30, "Die Variable ist grÃ¶ÃŸer als 30.", IF(
		varZahl >= 20, "Die Variable ist grÃ¶ÃŸer als 20.", IF(
			varZahl >=10, "Die Variable ist grÃ¶ÃŸer als 10.", IF(
				varZahl < 10, "Die Variable ist kleiner als 10."
)))))

=IF(
FALSE, -, IF(
	FALSE, -, IF(
		varZahl >= 20, "Die Variable ist grÃ¶ÃŸer als 20.", IF(
			varZahl >=10, "Die Variable ist grÃ¶ÃŸer als 10.", IF(
				varZahl < 10, "Die Variable ist kleiner als 10."
)))))

=IF(
FALSE, -, IF(
	FALSE, -, IF(
		TRUE, "Die Variable ist grÃ¶ÃŸer als 20.", -
)))


=IF(
FALSE, -, IF(
	FALSE, -, "Die Variable ist grÃ¶ÃŸer als 20."
))

=IF(
FALSE, -, "Die Variable ist grÃ¶ÃŸer als 20."
)

="Die Variable ist grÃ¶ÃŸer als 20."
```

### IFERROR und IFNA

Eine `IFERROR` und `IFNA` funktionieren letztlich nach dem gleichen Prinzip wie eine normale `IF` Funktion. Hier ist der Wahrheitstest allerdings direkt in die Funktion integriert und Ã¼berprÃ¼ft, ob bei der Ã¼bergebenen Formel ein allgemeiner Fehler (`IFERROR`), oder spezieller, ein NV-Fehler (`IFNA`) entsteht.

"Wenn die Formel einen Fehler ausgibt, dann tue bitte xyz, ansonsten fÃ¼hre die Formel aus."

```
=IFERROR(10+10,"Hier ist ein Fehler! Bitte Ã¼berprÃ¼fe die Formel!")
```

Wenn die Berechnung 10 + 10 einen Fehler ausgibt, dann gibt die `IFERROR` den Satz "Hier ist ein Fehler! Bitte Ã¼berprÃ¼fe die Formel!" aus. Wenn die Berechnung keinen Fehler ausgibt, wird das Ergebnis 20 angezeigt.

```
=IFERROR(10+10,"Hier ist ein Fehler! Bitte Ã¼berprÃ¼fe die Formel!")
=20
```

Provozieren wir nun einen Fehler, indem wir einen Text mit einer Zahl addieren mÃ¶chten:

```
=IFERROR(10+"abc","Hier ist ein Fehler! Bitte Ã¼berprÃ¼fe die Formel!")
="Hier ist ein Fehler! Bitte Ã¼berprÃ¼fe die Formel!"
```

Hier versuchen wir 10 mit abc zu addieren. Geht logischerweise nicht. Also wird ein `#VALUE` Fehler in Excel ausgegeben. Durch den Fehler wird unsere `IFERROR`-Formel getriggert und gibt uns den eingegebenen Text zurÃ¼ck.

> [!Info]
> WÃ¤hrend `IFERROR` und `IFNA` Formeln durchaus ihren Reiz haben, kÃ¶nnen sie auch "unvorhersehbares" Verhalten auslÃ¶sen. Das geschieht insbesondere dann, wenn anstelle des Fehlers eine 0 ausgegeben wird (`=IFERROR(Formel die Fehler generiert, 0)`). Mit einer 0 kÃ¶nnen wir weitere Berechnungen ausfÃ¼hren, mit einem Fehler nicht. Wenn wir also Spalten summieren, die eigentlich nur Fehler enthalten, anstelle eines Fehlers aber eine 0 ausgeben, erhalten wir als Ergebnis 0, obwohl unsere komplette Tabelle fehlerhaft ist.


## ğŸ“Œ WofÃ¼r ist das nÃ¼tzlich?
- Immer dann, wenn eine einfache logische Bedingung geprÃ¼ft und ein RÃ¼ckgabewert auf Grundlage des Ergebnis zurÃ¼ck gegeben werden muss.
- Wir sind zwar auf mehrfach verschachtelt eingegangen, da gibts aber einfachere und besser lesbare MÃ¶glichkeiten, wie z.B. die `IFS`, die direkt auf mehrere Bedingungen Ã¼berprÃ¼ft.

## ğŸ”¢ Beispiel
```excel
=IF(varDatum < TODAY(), "Bitte Ã¼berprÃ¼fe das Reportingdatum!", Berechnung)

# Formel im Namensmanager anlegen: Name = forGroesserAls
=LAMBDA(x, IF(
x >= 40, "Die Variable ist grÃ¶ÃŸer als 40.", IF(
	x >= 30, "Die Variable ist grÃ¶ÃŸer als 30.", IF(
		x >= 20, "Die Variable ist grÃ¶ÃŸer als 20.", IF(
			x >=10, "Die Variable ist grÃ¶ÃŸer als 10.", IF(
				x < 10, "Die Variable ist kleiner als 10."
)))))))
--> Funktionsaufruf Ã¼ber
=forGroesserAls(20) --> "Die Variable ist grÃ¶ÃŸer als 20."

# BedingungsÃ¼berprÃ¼fung mit Formel, die direkt einen booleschen Wert zurÃ¼ck gibt
=IF(ISNUMBER(15), "Es handelt sich um eine Zahl.", "Es handelt nicht um eine Zahl.")

=IF(20, 1, 0)
--> resultiert in 1, da 20 als TRUE interpretiert wird


```

## ğŸ’¡ Kreativer Einsatz
*Wie lÃ¤sst sich die Funktion clever kombinieren oder zweckentfremden?*
- Die KombinationsmÃ¶glichkeit der `IF`-Funktion und seiner Geschwister ist schier endlos. Aufgrund ihrer Natur tragen logische Funktionen einen groÃŸen Teil zu einem Systemaufbau bei. Sie sind meistens an entscheidungskritischen Stellen innerhalb eines Modells, da sie genau das machen: Eine Entscheidung treffen.
- Es sei ebenfalls darauf hingewiesen, dass die logischen Funktionen jede andere Zahl als 0 als `TRUE` auswerten, positive und negative. 

## âš  Typische Fehlerquellen
- Falsche BedinungsprÃ¼fungen (alles was nicht in `TRUE` oder `FALSE` resultiert), lÃ¶sen einen \#VALUE-Error aus.

## ğŸ§  Denkstruktur hinter der Funktion
*Optional: Wie funktioniert diese Funktion auf struktureller Ebene?*
Die `IF`-Funktion, sowie die Verschachtelung, zu verstehen sind wegweisend fÃ¼r komplexere Modelle. Vieles, was man in einem systematisch aufgebautem Modell macht, ist auf bedingte Logik zurÃ¼ck zu fÃ¼hren. Mit logischen Funktionen erstellt man die ersten "echten" Synapsen seines Modells.

